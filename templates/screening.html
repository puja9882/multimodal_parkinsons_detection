<!DOCTYPE html>
<html>
<head>
  <title>Parkinson's Screening Â· Run Test</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="layout-bg">
  <div class="bg-orbit"></div>

  <header class="app-header">
    <div class="header-left">
      <div class="logo-circle">
        <span class="logo-icon">PD</span>
      </div>
      <div class="app-title-block">
        <h1>Parkinson's Disease Screening</h1>
        <p class="app-subtitle">Multimodal ML using spiral drawing, speech and age</p>
      </div>
    </div>
    <nav class="nav-links">
      <a href="{{ url_for('home') }}" class="nav-link">Home</a>
      <a href="{{ url_for('screening') }}" class="nav-link nav-active">Screening</a>
      <a href="{{ url_for('about') }}" class="nav-link">About</a>
    </nav>
  </header>

  <main class="app-main">
    <!-- INPUT PANEL -->
    <section class="panel panel-input panel-modern">
      <h2>ğŸ¯ Patient Input</h2>
      <p class="panel-caption">
        Choose upload OR live input, then click Analyze.
      </p>

      <!-- FIXED AGE - LARGER + VISIBLE -->
      <div class="field-row age-field-enhanced">
        <label for="ageInput">ğŸ‘´ Age (years)</label>
        <input type="number" name="age" id="ageInput" min="1" max="120" placeholder="55" required 
               style="font-size: 20px; padding: 16px; background: rgba(255,255,255,0.95); color: #000; font-weight: 700;">
        <div id="ageFeedback" class="feedback"></div>
      </div>

      <!-- SPIRAL -->
      <div class="field-row">
        <label>âœï¸ Spiral Drawing</label>
        
        <!-- UPLOAD -->
        <div class="upload-option">
          <input type="file" name="spiral_img" id="drawingInput" accept="image/*">
          <span class="file-status" id="drawingStatus">ğŸ“ Upload PNG/JPG file</span>
        </div>

        <!-- LIVE DRAW -->
        <div class="live-option">
          <span class="option-label">OR draw live:</span>
          <div class="draw-area enhanced-draw">
            <canvas id="spiralCanvas"></canvas>
            <div class="draw-controls">
              <button type="button" class="btn btn-secondary draw-btn" onclick="clearCanvas()">ğŸ—‘ï¸ Clear</button>
              <button type="button" class="btn btn-primary draw-btn" onclick="useCanvasAsImage()">âœ… Use Drawing</button>
              <div id="drawFeedback" class="draw-score">Draw tight spiral â†’</div>
            </div>
          </div>
        </div>
      </div>

      <!-- VOICE -->
      <div class="field-row">
        <label>ğŸ¤ Voice Recording</label>
        
        <!-- UPLOAD -->
        <div class="upload-option">
          <input type="file" name="voice_wav" id="voiceInput" accept=".wav,audio/*">
          <span class="file-status" id="voiceStatus">ğŸ“ Upload WAV file</span>
        </div>

        <!-- LIVE RECORD -->
        <div class="live-option">
          <span class="option-label">OR record live:</span>
          <div class="record-area enhanced-record">
            <div class="record-buttons">
              <button type="button" class="btn btn-secondary record-btn" id="recordBtn" onclick="toggleRecording()">
                <span id="recordText">ğŸ™ï¸ Start Recording</span>
              </button>
              <button type="button" class="btn btn-secondary" onclick="clearRecording()" id="clearRecordBtn" style="display:none;">ğŸ—‘ï¸ Clear</button>
            </div>
            <div id="recordStatus" class="record-status">Speak "Ahhhh" for 5-10 seconds</div>
            <div id="recordWave" class="wave-visual" style="display:none;"></div>
            <audio id="recordedAudio" controls style="display:none; margin-top:8px; width:100%;"></audio>
          </div>
        </div>
      </div>

      <!-- Analyze Button -->
      <button class="btn btn-primary btn-large predict-btn" type="button" onclick="predict()" id="predictBtn">
        ğŸš€ Analyze Now
      </button>

      <p class="disclaimer">
        Academic research prototype only. Not medical diagnosis.
      </p>
    </section>

    <!-- OUTPUT PANEL - NO TECH DETAILS + FIXED TEXT -->
    <section class="panel panel-output panel-modern">
      <h2>ğŸ¤– AI Results</h2>
      <p class="panel-caption">
        Confidence meter + simple explanation.
      </p>

      <div id="result" class="result-container">
        <div class="result-summary result-neutral">
          <div class="confidence-meter">
            <div class="confidence-bar">
              <div class="confidence-fill" style="width:0%"></div>
            </div>
            <div class="confidence-labels">
              <span>Low Confidence</span>
              <span>High Confidence</span>
            </div>
          </div>
          <div class="result-main">
            <div>
              <span class="result-label">Prediction</span>
              <div class="result-value" id="predValue">Ready</div>
            </div>
            <div>
              <span class="result-label">Confidence</span>
              <div class="result-value" id="confValue">â€“</div>
            </div>
          </div>
          <div id="confidenceExplanation" class="confidence-explain">
            <strong>Confidence Score:</strong><br>
            0-25%: Very uncertain | 25-50%: Fair | 50-75%: Good | 75-100%: Very confident
          </div>
          <p class="result-note" id="resultNote">
            Provide spiral drawing and voice recording to get instant analysis.
          </p>
        </div>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <span>Parkinson's Multimodal ML Â· Academic Research Prototype</span>
  </footer>

  <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
